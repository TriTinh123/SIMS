@page "/weathers/edit"
@using SIMS.Pages.WeatherPages
@inject NavigationManager NavigationManager
@using Microsoft.AspNetCore.Components

<PageTitle>Edit Weather</PageTitle>

<div class="container-fluid p-4">
 <div class="d-flex align-items-center mb-4">
 <a href="/weathers" class="btn btn-outline-secondary me-3"><i class="bi bi-arrow-left"></i></a>
 <h1 class="mb-0"><i class="bi bi-pencil text-primary"></i> Edit Weather</h1>
 </div>

 <div class="row">
 <div class="col-md-6">
 <div class="card shadow-sm">
 <div class="card-body">
 @if (Item is null)
 {
 <div>Loading...</div>
 }
 else
 {
 <EditForm Model="Item" OnValidSubmit="SaveItem" FormName="edit-weather" method="post">
 <DataAnnotationsValidator />
 <ValidationSummary class="text-danger" />
 <input type="hidden" name="Item.Id" value="@Item.Id" />
 <div class="form-floating mb-3">
 <InputDate @bind-Value="Item.Date" class="form-control" />
 <label>Date</label>
 </div>
 <div class="form-floating mb-3">
 <InputNumber @bind-Value="Item.TemperatureC" class="form-control" />
 <label>Temperature (C)</label>
 </div>
 <div class="form-floating mb-3">
 <InputText @bind-Value="Item.Summary" class="form-control" placeholder="Summary" />
 <label>Summary</label>
 </div>
 <div class="d-flex gap-2">
 <button class="btn btn-primary" type="submit">Save</button>
 <a class="btn btn-outline-secondary" href="/weathers">Cancel</a>
 </div>
 </EditForm>
 }
 </div>
 </div>
 </div>
 </div>
</div>

@code {
 [SupplyParameterFromQuery]
 public int Id { get; set; }

 private WeatherStore.WeatherItem? Item { get; set; }

 protected override void OnInitialized()
 {
 Item = WeatherStore.GetById(Id);
 if (Item is null) NavigationManager.NavigateTo("notfound");
 }

 private void SaveItem()
 {
 WeatherStore.Update(Item!);
 NavigationManager.NavigateTo("/weathers");
 }
}
